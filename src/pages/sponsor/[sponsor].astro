---
import { Image } from "astro:assets";
import JobOfferCard from "../../components/JobOfferCard.astro";
import RichText from "../../components/RichText.astro";
import Socials from "../../components/Socials.astro";
import { DATA } from "../../data/data";
import Layout from "../../layouts/Layout.astro";

export function getStaticPaths() {
  return DATA.sponsors
    .filter((sponsor) => sponsor.hasFeaturedPage)
    .map((sponsor) => ({
      params: { sponsor: sponsor.name },
    }));
}

const { sponsor } = Astro.params;

const sponsorData = DATA.sponsors.find((s) => s.name === sponsor);

if (!sponsorData || sponsorData.hasFeaturedPage === false) {
  return Astro.redirect("/");
}
---
<Layout
  title={`${sponsorData.name} | ${DATA.title}`}
  description={sponsorData.description}
  lang="es"
>
  <main class="flex flex-col gap-6 min-h-screen wrapper">
    <section class=" flex flex-col md:flex-row gap-4 mb-12">
      <div class="md:w-1/2 bg-green-400 p-4">
        <Image
          transition:name={sponsorData.name}
          class="w-full h-full object-contain bg-white p-4"
          src={sponsorData.picture}
          alt={sponsorData.name}
          height={400}
          width={400}
        />
      </div>
      {
        !!sponsorData.description !== undefined && (
          <div class="md:w-1/2 flex flex-col gap-2 p-4">
            <div class="flex justify-between border-b border-gray-300 pb-2">
              <h1 class="text-3xl font-bold">{sponsorData.name}</h1>
              <Socials
                socials={sponsorData.socials}
                class="text-4xl text-green-600 dark:text-blue-600 hover:text-green-400 hover:dark:text-blue-400"
              />
            </div>
            <div class="text-lg">
              <RichText text={sponsorData.description} />
            </div>
          </div>
        )
      }
    </section>
    {
      !!sponsorData.jobOffers.length && (
        <>
          <h3 class="text-3xl font-bold mx-auto text-center">
            Ofertas de Trabajo
          </h3>
          <section class="grid grid-cols-1 lg:grid-cols-2 py-2 px-6 pb-10 gap-6">
            {sponsorData.jobOffers.map((jobOffer) => (
              <JobOfferCard jobOffer={jobOffer} />
            ))}
          </section>
        </>
      )
    }
  </main>
</Layout>
